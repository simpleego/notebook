# 조인vs서브쿼리
> SQL에서 **JOIN**과 **서브쿼리(Subquery)**는 모두 테이블 간의 관계를 활용해 데이터를 조회하는 데 사용되지만,
> **사용 목적과 성능, 가독성**에 따라 선택 기준이 달라집니다.
  
---

## 🧭 조인 vs 서브쿼리 선택 기준

| 기준 항목             | JOIN 사용이 적합한 경우                              | 서브쿼리 사용이 적합한 경우                          |
|----------------------|------------------------------------------------------|------------------------------------------------------|
| **복합 데이터 조회**   | 여러 테이블의 컬럼을 함께 보여줘야 할 때              | 단일 테이블의 특정 조건만 필터링할 때                |
| **가독성**            | 관계가 명확하고 직관적인 경우                        | 조건이 복잡하거나 중첩된 필터링이 필요한 경우        |
| **성능**              | 인덱스가 잘 잡혀 있고, projection이 많은 경우         | 필터링만 하고 projection이 적을 때 더 효율적일 수 있음 |
| **NULL 처리**         | `LEFT JOIN + IS NULL` 방식이 더 안전함           | `NOT IN` 서브쿼리는 NULL 값이 있으면 오류 발생 가능 |
| **집계 처리**         | `GROUP BY`와 함께 여러 테이블의 집계를 할 때          | 중간 집계 결과를 만들고 그 위에서 다시 집계할 때 |
| **재사용성**          | 뷰(View)나 CTE(Common Table Expression)로 재사용 가능 | 인라인 서브쿼리는 재사용이 어려움                    |

---

## 🎯 실전 예시로 보는 선택 기준

### ✅ 조인이 더 적합한 경우
```sql
SELECT s.id, s.name, sg.grade
FROM student s
JOIN student_grade sg ON s.id = sg.student_id
WHERE sg.grade >= 90;
```
- 학생 정보와 성적을 함께 보여줘야 하므로 JOIN이 적합

### ✅ 서브쿼리가 더 적합한 경우
```sql
SELECT s.id, s.name
FROM student s
WHERE EXISTS (
  SELECT 1 FROM student_grade sg
  WHERE sg.student_id = s.id AND sg.grade = 90
);
```
- 성적이 90인 학생만 필터링하고 싶을 때, 성적 정보는 보여줄 필요 없음 → 서브쿼리로 필터링만 수행

---

## 💡 실무 팁
- **JOIN은 projection 중심**, **서브쿼리는 필터링 중심**으로 생각하면 선택이 쉬워집니다.
- **EXISTS** 또는 **NOT EXISTS**는 성능이 좋고 NULL 문제도 피할 수 있어 실무에서 자주 사용됩니다.
- 복잡한 쿼리는 **CTE(Common Table Expression)**로 구조를 나누면 가독성과 유지보수성이 좋아집니다.

---
